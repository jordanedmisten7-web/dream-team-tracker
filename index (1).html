<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dream Team Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="theme-color" content="#2563eb">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Dream Team">
  <style>
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
    .fade-in { animation: fadeIn 0.3s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const SUPA_URL = 'https://pcbxskoyolhrcviezlam.supabase.co';
    const SUPA_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBjYnhza295b2xocmN2aWV6bGFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NDE4MjksImV4cCI6MjA4NjQxNzgyOX0.RhlplUATyY6lcqp-v8eczHcYmnbiHhI9KmP84mwfzbM';
    const supa = window.supabase.createClient(SUPA_URL, SUPA_KEY);

    const PhoneIcon = () => (
      <svg className="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
      </svg>
    );
    const QuoteIcon = () => (
      <svg className="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg>
    );
    const DollarIcon = () => (
      <svg className="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    );

    const INITIAL_DATA = {
      '2026-01-21': { Jordan: { calls:27,quotes:13,sales:1,premium:742 }, Shawn: { calls:52,quotes:26,sales:0,premium:0 }, Alex: { calls:10,quotes:17,sales:2,premium:2530 } },
      '2026-01-22': { Jordan: { calls:22,quotes:12,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:8,quotes:12,sales:2,premium:3965 } },
      '2026-01-23': { Jordan: { calls:8,quotes:7,sales:3,premium:1720 }, Shawn: { calls:34,quotes:17,sales:0,premium:0 }, Alex: { calls:8,quotes:10,sales:0,premium:0 } },
      '2026-01-24': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-01-25': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-01-26': { Jordan: { calls:27,quotes:12,sales:3,premium:3345 }, Shawn: { calls:30,quotes:15,sales:2,premium:2357 }, Alex: { calls:10,quotes:16,sales:1,premium:839 } },
      '2026-01-27': { Jordan: { calls:26,quotes:13,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:8,quotes:5,sales:0,premium:0 } },
      '2026-01-28': { Jordan: { calls:32,quotes:16,sales:0,premium:0 }, Shawn: { calls:34,quotes:17,sales:0,premium:0 }, Alex: { calls:8,quotes:7,sales:0,premium:0 } },
      '2026-01-29': { Jordan: { calls:26,quotes:13,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:8,quotes:10,sales:0,premium:0 } },
      '2026-01-30': { Jordan: { calls:8,quotes:4,sales:1,premium:296 }, Shawn: { calls:36,quotes:18,sales:2,premium:2525 }, Alex: { calls:8,quotes:7,sales:0,premium:0 } },
      '2026-01-31': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-02-01': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-02-02': { Jordan: { calls:22,quotes:9,sales:1,premium:2609 }, Shawn: { calls:45,quotes:17,sales:0,premium:0 }, Alex: { calls:10,quotes:6,sales:2,premium:2299 } },
      '2026-02-03': { Jordan: { calls:28,quotes:13,sales:1,premium:1384 }, Shawn: { calls:2,quotes:0,sales:0,premium:0 }, Alex: { calls:12,quotes:8,sales:2,premium:1218 } },
      '2026-02-04': { Jordan: { calls:51,quotes:12,sales:0,premium:0 }, Shawn: { calls:47,quotes:26,sales:1,premium:367 }, Alex: { calls:15,quotes:9,sales:0,premium:0 } },
      '2026-02-05': { Jordan: { calls:58,quotes:13,sales:0,premium:0 }, Shawn: { calls:1,quotes:2,sales:2,premium:1509 }, Alex: { calls:15,quotes:12,sales:1,premium:682 } },
      '2026-02-06': { Jordan: { calls:30,quotes:10,sales:0,premium:0 }, Shawn: { calls:32,quotes:13,sales:0,premium:0 }, Alex: { calls:10,quotes:5,sales:1,premium:392 } },
      '2026-02-07': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-02-08': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } },
      '2026-02-09': { Jordan: { calls:102,quotes:16,sales:1,premium:603 }, Shawn: { calls:42,quotes:17,sales:0,premium:0 }, Alex: { calls:12,quotes:10,sales:1,premium:1852 } },
      '2026-02-10': { Jordan: { calls:0,quotes:0,sales:0,premium:0 }, Shawn: { calls:0,quotes:0,sales:0,premium:0 }, Alex: { calls:0,quotes:0,sales:0,premium:0 } }
    };

    function App() {
      const getET = () => {
        const now = new Date();
        const et = new Date(now.toLocaleString('en-US', { timeZone: 'America/New_York' }));
        return `${et.getFullYear()}-${String(et.getMonth()+1).padStart(2,'0')}-${String(et.getDate()).padStart(2,'0')}`;
      };

      const agents = ['Jordan','Shawn','Alex'];
      const [page, setPage] = useState('dashboard');
      const [agent, setAgent] = useState('Jordan');
      const [stats, setStats] = useState({});
      const [activity, setActivity] = useState([]);
      const [edits, setEdits] = useState({});
      const [loading, setLoading] = useState(true);
      const [syncStatus, setSyncStatus] = useState('synced');
      const [action, setAction] = useState(null);
      const [callQty, setCallQty] = useState('');
      const [quoteQty, setQuoteQty] = useState('');
      const [date, setDate] = useState(getET);
      const [adminMode, setAdminMode] = useState(false);
      const [adminPw, setAdminPw] = useState('');
      const [sales, setSales] = useState([]);
      const [policies, setPolicies] = useState({Auto:false,Home:false,Life:false,Bundle:false});
      const [premiums, setPremiums] = useState({Auto:'',Home:'',Life:'',Bundle:''});
      const [bundleTypes, setBundleTypes] = useState({Auto:false,Home:false,Life:false});
      const [bundlePremiums, setBundlePremiums] = useState({Auto:'',Home:'',Life:''});
      const [diveMode, setDiveMode] = useState(false);
      const [divePw, setDivePw] = useState('');
      const [successScreen, setSuccessScreen] = useState(false);
      const [successData, setSuccessData] = useState(null);

      // Load from Supabase
      const loadData = async () => {
        try {
          const { data, error } = await supa.from('dream_team_data').select('*');
          if (error) throw error;
          data.forEach(row => {
            if (row.id === 'stats') setStats(Object.keys(row.data).length ? row.data : INITIAL_DATA);
            if (row.id === 'activity') setActivity(Array.isArray(row.data) ? row.data : []);
            if (row.id === 'edits') setEdits(row.data || {});
          });
          if (!data.find(r => r.id === 'stats' && Object.keys(r.data).length)) {
            await supa.from('dream_team_data').upsert({ id:'stats', data: INITIAL_DATA });
            setStats(INITIAL_DATA);
          }
        } catch (err) {
          console.error('Load error:', err);
          setStats(INITIAL_DATA);
        } finally {
          setLoading(false);
        }
      };

      useEffect(() => {
        loadData();

        // Real-time subscription
        const sub = supa.channel('dream_team_changes')
          .on('postgres_changes', { event:'*', schema:'public', table:'dream_team_data' }, (payload) => {
            const row = payload.new;
            if (row.id === 'stats') setStats(row.data);
            if (row.id === 'activity') setActivity(Array.isArray(row.data) ? row.data : []);
            if (row.id === 'edits') setEdits(row.data || {});
            setSyncStatus('synced');
          })
          .subscribe();

        return () => supa.removeChannel(sub);
      }, []);

      const saveStats = async (newStats) => {
        setSyncStatus('saving');
        setStats(newStats);
        const { error } = await supa.from('dream_team_data').upsert({ id:'stats', data: newStats });
        if (error) { console.error('Save error:', error); setSyncStatus('error'); }
        else setSyncStatus('synced');
      };

      const saveActivity = async (newActivity) => {
        setActivity(newActivity);
        await supa.from('dream_team_data').upsert({ id:'activity', data: newActivity });
      };

      const saveEdits = async (newEdits) => {
        setEdits(newEdits);
        await supa.from('dream_team_data').upsert({ id:'edits', data: newEdits });
      };

      // Bundle auto-calculate
      useEffect(() => {
        if (policies.Bundle) {
          const total = Object.keys(bundleTypes).reduce((sum, t) => {
            return bundleTypes[t] && bundlePremiums[t] ? sum + parseFloat(bundlePremiums[t]) : sum;
          }, 0);
          setPremiums(p => ({ ...p, Bundle: total > 0 ? total.toFixed(2) : '' }));
        }
      }, [bundlePremiums, bundleTypes, policies.Bundle]);

      const getTotals = () => {
        const totals = { Jordan:{calls:0,quotes:0,sales:0,premium:0}, Shawn:{calls:0,quotes:0,sales:0,premium:0}, Alex:{calls:0,quotes:0,sales:0,premium:0} };
        Object.values(stats).forEach(day => {
          agents.forEach(a => {
            totals[a].calls += day[a]?.calls||0;
            totals[a].quotes += day[a]?.quotes||0;
            totals[a].sales += day[a]?.sales||0;
            totals[a].premium += day[a]?.premium||0;
          });
        });
        return totals;
      };

      const getAllTime = () => {
        const totals = { Jordan:{calls:0,quotes:0,sales:0,premium:0,bestDay:{date:'',premium:0}}, Shawn:{calls:0,quotes:0,sales:0,premium:0,bestDay:{date:'',premium:0}}, Alex:{calls:0,quotes:0,sales:0,premium:0,bestDay:{date:'',premium:0}} };
        Object.keys(stats).forEach(d => {
          agents.forEach(a => {
            const day = stats[d][a];
            totals[a].calls += day?.calls||0;
            totals[a].quotes += day?.quotes||0;
            totals[a].sales += day?.sales||0;
            totals[a].premium += day?.premium||0;
            if ((day?.premium||0) > totals[a].bestDay.premium) totals[a].bestDay = { date:d, premium:day?.premium||0 };
          });
        });
        return totals;
      };

      const getBadges = () => {
        const t = getTotals();
        return {
          premium: agents.reduce((l, a) => t[a].premium > t[l].premium ? a : l),
          calls: agents.reduce((l, a) => t[a].calls > t[l].calls ? a : l),
          sales: agents.reduce((l, a) => t[a].sales > t[l].sales ? a : l),
          closer: agents.reduce((l, a) => {
            const ar = t[a].quotes > 0 ? t[a].sales/t[a].quotes : 0;
            const lr = t[l].quotes > 0 ? t[l].sales/t[l].quotes : 0;
            return ar > lr ? a : l;
          })
        };
      };

      const addSale = () => {
        const types = Object.keys(policies).filter(p => policies[p]);
        if (!types.length) return alert('Select at least one policy type');
        for (let p of types) {
          if (!premiums[p] || parseFloat(premiums[p]) <= 0) return alert(`Enter premium for ${p}`);
        }
        if (policies.Bundle) {
          const bt = Object.keys(bundleTypes).filter(t => bundleTypes[t]);
          if (!bt.length) return alert('Select bundle types');
          for (let t of bt) {
            if (!bundlePremiums[t] || parseFloat(bundlePremiums[t]) <= 0) return alert(`Enter premium for ${t}`);
          }
        }
        const total = types.reduce((sum, p) => sum + (parseFloat(premiums[p])||0), 0);
        setSales([...sales, { id: Date.now(), description: types.join(' + '), premium: total }]);
        setPolicies({Auto:false,Home:false,Life:false,Bundle:false});
        setPremiums({Auto:'',Home:'',Life:'',Bundle:''});
        setBundleTypes({Auto:false,Home:false,Life:false});
        setBundlePremiums({Auto:'',Home:'',Life:''});
      };

      const handleLog = async () => {
        if (!action) return alert('Select an action first');
        const updated = { ...stats };
        if (!updated[date]) updated[date] = {
          Jordan:{calls:0,quotes:0,sales:0,premium:0},
          Shawn:{calls:0,quotes:0,sales:0,premium:0},
          Alex:{calls:0,quotes:0,sales:0,premium:0}
        };
        let info = {};

        if (action === 'call' && callQty) {
          updated[date][agent].calls += parseInt(callQty);
          info = { type:'calls', quantity:callQty, agent, date };
          const newAct = [{ id:Date.now(), timestamp:new Date().toISOString(), action:'call', agent, details:`${callQty} calls` }, ...activity].slice(0,50);
          await saveActivity(newAct);
        } else if (action === 'quote' && quoteQty) {
          updated[date][agent].quotes += parseInt(quoteQty);
          info = { type:'quotes', quantity:quoteQty, agent, date };
          const newAct = [{ id:Date.now(), timestamp:new Date().toISOString(), action:'quote', agent, details:`${quoteQty} quotes` }, ...activity].slice(0,50);
          await saveActivity(newAct);
        } else if (action === 'sale') {
          if (!sales.length) return alert('Add at least one sale first');
          const totalPremium = sales.reduce((s, x) => s + x.premium, 0);
          updated[date][agent].premium += totalPremium;
          updated[date][agent].sales += sales.length;
          info = { type:'sales', totalSales:sales.length, totalPremium, sales:[...sales], agent, date };
          const desc = sales.map(s => `${s.description} ($${s.premium.toLocaleString()})`).join(', ');
          const newAct = [{ id:Date.now(), timestamp:new Date().toISOString(), action:'sale', agent, details:`${sales.length} sale(s): ${desc}` }, ...activity].slice(0,50);
          await saveActivity(newAct);
          setSales([]);
        }

        await saveStats(updated);
        setSuccessData(info);
        setSuccessScreen(true);
        setAction(null);
        setCallQty('');
        setQuoteQty('');
      };

      const handleEditEntry = async (d, field, val) => {
        const updated = { ...stats };
        if (updated[d]?.[agent]) {
          updated[d][agent][field] = parseFloat(val)||0;
          await saveStats(updated);
          const key = `${agent}-${d}-${field}`;
          const newEdits = { ...edits, [key]: { agent, date:d, field, count:(edits[key]?.count||0)+1, lastEdited:new Date().toISOString() } };
          await saveEdits(newEdits);
          alert('‚úÖ Updated and synced!');
        }
      };

      const exportCSV = () => {
        let csv = 'Date,Agent,Calls,Quotes,Sales,Premium\n';
        Object.keys(stats).sort().forEach(d => {
          agents.forEach(a => {
            const s = stats[d][a];
            csv += `${d},${a},${s.calls},${s.quotes},${s.sales},${s.premium}\n`;
          });
        });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(new Blob([csv], {type:'text/csv'}));
        a.download = `dream-team-${getET()}.csv`;
        a.click();
      };

      const resetData = async () => {
        if (confirm('‚ö†Ô∏è Reset ALL data to historical values? Cannot be undone!')) {
          await saveStats(INITIAL_DATA);
          alert('‚úÖ Data reset!');
        }
      };

      const totals = getTotals();
      const badges = getBadges();

      const SyncBadge = () => (
        <span className={`text-xs px-2 py-1 rounded-full font-semibold ${
          syncStatus === 'synced' ? 'bg-green-100 text-green-700' :
          syncStatus === 'saving' ? 'bg-yellow-100 text-yellow-700' :
          'bg-red-100 text-red-700'
        }`}>
          {syncStatus === 'synced' ? '‚úÖ Synced' : syncStatus === 'saving' ? '‚è≥ Saving...' : '‚ùå Error'}
        </span>
      );

      if (loading) return (
        <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center">
          <div className="text-center">
            <div className="text-6xl mb-4">üîÑ</div>
            <div className="text-xl font-bold">Loading Dream Team...</div>
            <div className="text-gray-500 mt-2">Connecting to database...</div>
          </div>
        </div>
      );

      // ‚îÄ‚îÄ‚îÄ SUCCESS SCREEN ‚îÄ‚îÄ‚îÄ
      if (page === 'input' && successScreen && successData) return (
        <div className="min-h-screen bg-gradient-to-br from-green-50 to-emerald-50 flex items-center justify-center p-4">
          <div className="max-w-2xl w-full bg-white rounded-2xl shadow-2xl p-8 text-center fade-in">
            <div className="text-8xl mb-4">üéâ</div>
            <h1 className="text-4xl font-black text-green-600 mb-2">Success!</h1>
            <p className="text-gray-600 mb-2">Logged and synced across all devices</p>
            <SyncBadge />
            <div className="bg-green-50 border-2 border-green-300 rounded-xl p-6 my-6">
              <div className="text-lg font-semibold mb-4">
                {successData.agent} ‚Äî {new Date(successData.date + 'T12:00:00').toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'})}
              </div>
              {successData.type === 'calls' && <div><div className="text-6xl font-black text-blue-600">{successData.quantity}</div><div className="text-xl text-gray-600">Calls Logged</div></div>}
              {successData.type === 'quotes' && <div><div className="text-6xl font-black text-indigo-600">{successData.quantity}</div><div className="text-xl text-gray-600">Quotes Logged</div></div>}
              {successData.type === 'sales' && (
                <div>
                  <div className="grid grid-cols-2 gap-4 mb-4">
                    <div className="bg-white rounded-lg p-4"><div className="text-4xl font-black text-green-600">{successData.totalSales}</div><div className="text-sm text-gray-600">Sales</div></div>
                    <div className="bg-white rounded-lg p-4"><div className="text-4xl font-black text-emerald-600">${successData.totalPremium.toLocaleString()}</div><div className="text-sm text-gray-600">Premium</div></div>
                  </div>
                  {successData.sales.map((s,i) => (
                    <div key={i} className="bg-white rounded-lg p-3 flex justify-between mb-2">
                      <span className="font-semibold">{s.description}</span>
                      <span className="text-green-600 font-bold">${s.premium.toLocaleString()}</span>
                    </div>
                  ))}
                </div>
              )}
            </div>
            <div className="flex gap-3">
              <button onClick={() => { setSuccessScreen(false); setSuccessData(null); }} className="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-lg">Log Another</button>
              <button onClick={() => { setSuccessScreen(false); setSuccessData(null); setPage('dashboard'); }} className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-lg">Dashboard</button>
            </div>
          </div>
        </div>
      );

      // ‚îÄ‚îÄ‚îÄ DEEP DIVE ‚îÄ‚îÄ‚îÄ
      if (page === 'input' && diveMode) {
        const entries = Object.keys(stats).filter(d => stats[d][agent]).sort().reverse();
        return (
          <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-4 md:p-8">
            <div className="max-w-6xl mx-auto">
              <div className="bg-blue-600 rounded-xl p-6 mb-6">
                <div className="flex items-center justify-between">
                  <div>
                    <h1 className="text-2xl md:text-3xl font-black text-white">Full Folio Deep Dive</h1>
                    <p className="text-blue-100">Agent: {agent}</p>
                  </div>
                  <button onClick={() => setDiveMode(false)} className="px-4 py-2 bg-white/20 text-white font-bold rounded-lg">‚Üê Back</button>
                </div>
              </div>
              <div className="bg-white rounded-lg p-4 md:p-6">
                <div className="space-y-4">
                  {entries.map(d => {
                    const entry = stats[d][agent];
                    const [y,m,dy] = d.split('-');
                    const display = new Date(parseInt(y), parseInt(m)-1, parseInt(dy));
                    return (
                      <div key={d} className="border-2 border-gray-200 rounded-lg p-4 bg-gray-50">
                        <h3 className="text-lg font-bold mb-4">{display.toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}</h3>
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                          {['calls','quotes','sales','premium'].map(field => (
                            <div key={field}>
                              <label className="block text-sm font-semibold text-gray-600 mb-1 capitalize">{field} {field==='premium'?'($)':''}</label>
                              <input type="number" defaultValue={entry[field]} onBlur={e => handleEditEntry(d, field, e.target.value)} className="w-full px-3 py-2 border rounded-lg" />
                            </div>
                          ))}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>
          </div>
        );
      }

      // ‚îÄ‚îÄ‚îÄ INPUT PAGE ‚îÄ‚îÄ‚îÄ
      if (page === 'input') return (
        <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-4 md:p-8">
          <div className="max-w-4xl mx-auto">
            <div className="bg-blue-600 rounded-xl p-6 mb-6">
              <div className="flex items-center gap-4">
                <button onClick={() => setPage('dashboard')} className="px-4 py-2 bg-white/20 text-white font-bold rounded-lg">‚Üê Back</button>
                <div>
                  <h1 className="text-2xl md:text-3xl font-black text-white">Log Activity</h1>
                  <div className="flex items-center gap-2"><p className="text-blue-100">Agent: {agent}</p><SyncBadge /></div>
                </div>
              </div>
            </div>

            {/* Deep Dive Banner */}
            <div className="bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg p-4 md:p-6 mb-6">
              <div className="flex flex-col md:flex-row items-center justify-between gap-4">
                <div>
                  <h3 className="text-lg font-bold text-white">üîç Full Folio Deep Dive</h3>
                  <p className="text-purple-100 text-sm">View and edit all your entries</p>
                </div>
                <div className="flex gap-3 w-full md:w-auto">
                  <input type="password" value={divePw} onChange={e => setDivePw(e.target.value)} onKeyPress={e => { if(e.key==='Enter'){ if(divePw===`${agent}1`){setDiveMode(true);setDivePw('');}else{alert('Wrong password');setDivePw('');}}}} placeholder="Password" className="flex-1 md:w-40 px-4 py-2 rounded-lg bg-white/10 border border-white/30 text-white placeholder-white/60" />
                  <button onClick={() => { if(divePw===`${agent}1`){setDiveMode(true);setDivePw('');}else{alert('Wrong password');setDivePw('');} }} className="px-6 py-2 bg-white text-purple-600 font-bold rounded-lg">Enter</button>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 md:p-6">
              {/* Date */}
              <div className="flex flex-col md:flex-row items-start md:items-center justify-between mb-6 gap-3">
                <div>
                  <h2 className="text-xl font-bold">Select Date</h2>
                  <p className="text-xs text-gray-500">Logging for: {date} (Eastern Time)</p>
                </div>
                <div className="flex gap-2">
                  <button onClick={() => setDate(getET())} className="px-3 py-2 bg-blue-100 text-blue-700 font-semibold rounded-lg text-sm">Today</button>
                  <input type="date" value={date} onChange={e => setDate(e.target.value)} className="px-4 py-2 border rounded-lg" />
                </div>
              </div>

              {/* Action Buttons */}
              <div className="grid grid-cols-3 gap-3 mb-6">
                {[['call','Calls',<PhoneIcon/>,'blue'],['quote','Quotes',<QuoteIcon/>,'indigo'],['sale','Sales',<DollarIcon/>,'green']].map(([val,label,icon,color]) => (
                  <button key={val} onClick={() => setAction(val)} className={`p-4 rounded-lg border-2 transition-all ${action===val ? `border-${color}-500 bg-${color}-50` : 'border-gray-200 hover:border-gray-300'}`}>
                    {icon}
                    <span className="font-semibold text-sm mt-1 block">{label}</span>
                  </button>
                ))}
              </div>

              {action === 'call' && (
                <div className="mb-5">
                  <label className="block text-sm font-semibold mb-2">Number of Calls</label>
                  <input type="number" value={callQty} onChange={e => setCallQty(e.target.value)} className="w-full px-4 py-3 border rounded-lg text-lg" placeholder="e.g. 25" />
                </div>
              )}

              {action === 'quote' && (
                <div className="mb-5">
                  <label className="block text-sm font-semibold mb-2">Number of Quotes</label>
                  <input type="number" value={quoteQty} onChange={e => setQuoteQty(e.target.value)} className="w-full px-4 py-3 border rounded-lg text-lg" placeholder="e.g. 10" />
                </div>
              )}

              {action === 'sale' && (
                <div className="mb-5 space-y-4">
                  {sales.length > 0 && (
                    <div className="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                      <h3 className="font-bold text-green-800 mb-3">Sales to Submit ({sales.length})</h3>
                      {sales.map(s => (
                        <div key={s.id} className="flex items-center justify-between bg-white p-3 rounded-lg mb-2">
                          <div><span className="font-semibold">{s.description}</span><span className="text-green-600 font-bold ml-3">${s.premium.toLocaleString()}</span></div>
                          <button onClick={() => setSales(sales.filter(x => x.id !== s.id))} className="text-red-500 font-bold px-2">‚úï</button>
                        </div>
                      ))}
                      <div className="pt-2 border-t border-green-200 flex justify-between font-bold">
                        <span>Total:</span>
                        <span className="text-green-700 text-xl">${sales.reduce((s,x)=>s+x.premium,0).toLocaleString()} ({sales.length} sales)</span>
                      </div>
                    </div>
                  )}
                  <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                    <h3 className="font-bold text-blue-800 mb-3">Add Sale #{sales.length+1}</h3>
                    {['Auto','Home','Life','Bundle'].map(pt => (
                      <div key={pt} className="bg-white rounded-lg p-4 border mb-3">
                        <div className="flex items-center gap-3 mb-2">
                          <input type="checkbox" id={pt} checked={policies[pt]} onChange={e => setPolicies({...policies,[pt]:e.target.checked})} className="w-5 h-5" />
                          <label htmlFor={pt} className="font-semibold text-base">{pt} Policy</label>
                        </div>
                        {policies[pt] && pt !== 'Bundle' && (
                          <input type="number" value={premiums[pt]} onChange={e => setPremiums({...premiums,[pt]:e.target.value})} placeholder="Premium amount" className="w-full px-4 py-3 border rounded-lg mt-2" />
                        )}
                        {policies[pt] && pt === 'Bundle' && (
                          <div className="mt-3 space-y-3">
                            {['Auto','Home','Life'].map(bt => (
                              <div key={bt}>
                                <div className="flex items-center gap-2 mb-2">
                                  <input type="checkbox" checked={bundleTypes[bt]} onChange={e => setBundleTypes({...bundleTypes,[bt]:e.target.checked})} className="w-4 h-4" />
                                  <label className="text-sm font-semibold">{bt}</label>
                                </div>
                                {bundleTypes[bt] && (
                                  <input type="number" value={bundlePremiums[bt]} onChange={e => setBundlePremiums({...bundlePremiums,[bt]:e.target.value})} placeholder={`${bt} premium`} className="w-full px-3 py-2 border rounded ml-6" />
                                )}
                              </div>
                            ))}
                            {Object.values(bundleTypes).some(v=>v) && (
                              <div className="p-3 bg-blue-50 border-2 border-blue-300 rounded-lg">
                                <label className="block text-xs font-semibold mb-2">Bundle Total (Auto-calculated)</label>
                                <input type="text" value={premiums.Bundle} readOnly className="w-full px-4 py-3 bg-white border-2 rounded-lg font-bold" />
                              </div>
                            )}
                          </div>
                        )}
                      </div>
                    ))}
                    <button onClick={addSale} className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg">‚úö Add This Sale</button>
                  </div>
                </div>
              )}

              <button onClick={handleLog} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-lg text-lg">
                {action === 'sale' ? `Submit ${sales.length} Sale(s)` : 'Submit Entry'}
              </button>
            </div>
          </div>
        </div>
      );

      // ‚îÄ‚îÄ‚îÄ ADMIN PAGE ‚îÄ‚îÄ‚îÄ
      if (page === 'admin') {
        if (!adminMode) return (
          <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center p-4">
            <div className="bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center">
              <div className="text-6xl mb-4">üîê</div>
              <h2 className="text-2xl font-bold mb-6">Admin Access</h2>
              <input type="password" value={adminPw} onChange={e => setAdminPw(e.target.value)} onKeyPress={e => { if(e.key==='Enter'){ if(adminPw==='Admin1'){setAdminMode(true);}else{alert('Wrong password');} setAdminPw(''); }}} placeholder="Admin password" className="w-full px-4 py-3 border rounded-lg mb-4" />
              <button onClick={() => { if(adminPw==='Admin1'){setAdminMode(true);}else{alert('Wrong password');} setAdminPw(''); }} className="w-full bg-blue-600 text-white font-bold py-3 rounded-lg mb-3">Login</button>
              <button onClick={() => setPage('dashboard')} className="w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-lg">‚Üê Back</button>
            </div>
          </div>
        );

        const allTime = getAllTime();
        return (
          <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-4 md:p-8">
            <div className="max-w-7xl mx-auto">
              <div className="bg-blue-600 rounded-xl p-6 md:p-8 mb-6">
                <div className="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                  <div>
                    <h1 className="text-3xl md:text-4xl font-black text-white">Admin Dashboard</h1>
                    <div className="flex items-center gap-2 mt-1"><p className="text-blue-100">All Time Stats</p><SyncBadge /></div>
                  </div>
                  <div className="flex gap-2 flex-wrap">
                    <button onClick={resetData} className="px-4 py-2 bg-orange-600 text-white font-bold rounded-lg text-sm">üîÑ Reset</button>
                    <button onClick={exportCSV} className="px-4 py-2 bg-green-600 text-white font-bold rounded-lg text-sm">üì• CSV</button>
                    <button onClick={() => setPage('dashboard')} className="px-4 py-2 bg-white/20 text-white font-bold rounded-lg text-sm">‚Üê Dashboard</button>
                  </div>
                </div>
              </div>

              {/* Edit History */}
              <div className="bg-white rounded-lg p-4 md:p-6 mb-6 border-2 border-orange-200">
                <h2 className="text-xl font-bold text-orange-600 mb-4">üìù Edit History</h2>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  {agents.map(a => {
                    const count = Object.values(edits).filter(e => e.agent===a).reduce((s,e)=>s+e.count,0);
                    const agentEdits = Object.values(edits).filter(e => e.agent===a);
                    return (
                      <div key={a} className="bg-orange-50 border-2 border-orange-200 rounded-lg p-4">
                        <h3 className="font-bold text-lg mb-1">{a}</h3>
                        <div className="text-4xl font-black text-orange-600">{count}</div>
                        <div className="text-sm text-gray-500">Total Edits</div>
                        {agentEdits.slice(-3).reverse().map((e,i) => {
                          const [y,m,d] = e.date.split('-');
                          return (
                            <div key={i} className="text-xs bg-white p-2 rounded mt-2">
                              <span className="font-semibold capitalize">{e.field}</span> on {new Date(parseInt(y),parseInt(m)-1,parseInt(d)).toLocaleDateString()}
                              <div className="text-gray-400">{e.count}x edits</div>
                            </div>
                          );
                        })}
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Agent Cards */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6">
                {agents.map(a => {
                  const s = allTime[a];
                  const cr = s.quotes > 0 ? Math.round((s.sales/s.quotes)*100) : 0;
                  return (
                    <div key={a} className="bg-white rounded-lg p-6 border shadow-sm">
                      <h3 className="text-xl font-bold mb-4 pb-3 border-b">{a}</h3>
                      <div className="space-y-3">
                        <div className="flex justify-between"><span className="text-gray-500">Calls</span><span className="text-xl font-bold text-blue-600">{s.calls}</span></div>
                        <div className="flex justify-between"><span className="text-gray-500">Quotes</span><span className="text-xl font-bold text-indigo-600">{s.quotes}</span></div>
                        <div className="flex justify-between"><span className="text-gray-500">Sales</span><span className="text-xl font-bold text-green-600">{s.sales}</span></div>
                        <div className="flex justify-between border-t pt-3"><span className="text-gray-500">Premium</span><span className="text-xl font-bold text-emerald-600">${s.premium.toLocaleString()}</span></div>
                        <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-3 flex justify-between">
                          <span className="font-semibold text-blue-900">Close Rate</span>
                          <span className="text-2xl font-bold text-blue-600">{cr}%</span>
                        </div>
                        {s.bestDay.premium > 0 && (() => {
                          const [y,m,d] = s.bestDay.date.split('-');
                          return (
                            <div className="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-3">
                              <div className="text-xs font-semibold text-yellow-800">üèÜ Best Day</div>
                              <div className="text-xl font-bold text-yellow-700">${s.bestDay.premium.toLocaleString()}</div>
                              <div className="text-xs text-yellow-600">{new Date(parseInt(y),parseInt(m)-1,parseInt(d)).toLocaleDateString()}</div>
                            </div>
                          );
                        })()}
                      </div>
                    </div>
                  );
                })}
              </div>

              {/* Team Totals */}
              <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                {[
                  ['blue-600', agents.reduce((s,a)=>s+allTime[a].calls,0), 'Team Calls'],
                  ['indigo-600', agents.reduce((s,a)=>s+allTime[a].quotes,0), 'Team Quotes'],
                  ['green-600', agents.reduce((s,a)=>s+allTime[a].sales,0), 'Team Sales'],
                  ['emerald-600', '$'+agents.reduce((s,a)=>s+allTime[a].premium,0).toLocaleString(), 'Team Premium'],
                ].map(([color, val, label]) => (
                  <div key={label} className={`bg-${color} p-4 md:p-6 rounded-lg text-center`}>
                    <div className="text-2xl md:text-3xl font-bold text-white">{val}</div>
                    <div className="text-xs md:text-sm text-white font-medium">{label}</div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        );
      }

      // ‚îÄ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ‚îÄ
      return (
        <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-4 md:p-8">
          <div className="max-w-7xl mx-auto">
            <div className="bg-blue-600 rounded-xl p-6 md:p-8 mb-6">
              <div className="flex items-center justify-between">
                <div>
                  <h1 className="text-3xl md:text-4xl font-black text-white">Dream Team üèÜ</h1>
                  <div className="flex items-center gap-2 mt-1">
                    <p className="text-blue-100 text-sm">Live Synced Across All Devices</p>
                    <SyncBadge />
                  </div>
                </div>
                <button onClick={() => setPage('admin')} className="px-4 md:px-6 py-2 md:py-3 bg-white/20 text-white font-bold rounded-lg">üîê Admin</button>
              </div>
            </div>

            {/* Team Stats */}
            <div className="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
              {[
                ['bg-blue-500', Object.values(totals).reduce((s,a)=>s+a.calls,0), 'Calls'],
                ['bg-indigo-500', Object.values(totals).reduce((s,a)=>s+a.quotes,0), 'Quotes'],
                ['bg-green-500', Object.values(totals).reduce((s,a)=>s+a.sales,0), 'Sales'],
                ['bg-emerald-500', '$'+Object.values(totals).reduce((s,a)=>s+a.premium,0).toLocaleString(), 'Premium'],
              ].map(([bg, val, label]) => (
                <div key={label} className={`${bg} p-4 md:p-6 rounded-lg text-center`}>
                  <div className="text-2xl md:text-3xl font-bold text-white">{val}</div>
                  <div className="text-xs md:text-sm text-white">{label}</div>
                </div>
              ))}
            </div>

            {/* Agent Buttons */}
            <div className="bg-white rounded-lg p-4 md:p-6 mb-6">
              <h2 className="text-xl md:text-2xl font-bold mb-6 text-center">Select Your Name</h2>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                {agents.map(a => {
                  const s = totals[a];
                  const cr = s.quotes > 0 ? Math.round((s.sales/s.quotes)*100) : 0;
                  const ab = [];
                  if (badges.premium===a) ab.push('üëë Premium King');
                  if (badges.calls===a) ab.push('üìû Call Champ');
                  if (badges.sales===a) ab.push('üí∞ Sales Leader');
                  if (badges.closer===a) ab.push('üéØ Top Closer');
                  return (
                    <button key={a} onClick={() => { setAgent(a); setPage('input'); setDiveMode(false); }}
                      className="bg-blue-50 hover:bg-blue-100 border-2 border-blue-200 hover:border-blue-400 rounded-xl p-4 md:p-6 transition-all text-left">
                      <div className="text-center mb-4">
                        <div className="text-5xl mb-2">üë§</div>
                        <h3 className="text-xl md:text-2xl font-bold">{a}</h3>
                        {ab.length > 0 && (
                          <div className="flex flex-wrap justify-center gap-1 mt-2">
                            {ab.map((b,i) => <span key={i} className="text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-1 rounded-full">{b}</span>)}
                          </div>
                        )}
                      </div>
                      <div className="space-y-2">
                        <div className="flex justify-between bg-white p-2 rounded">
                          <span className="text-sm text-gray-600">Premium</span>
                          <span className="font-bold text-emerald-600">${s.premium.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between bg-white p-2 rounded">
                          <span className="text-sm text-gray-600">Sales</span>
                          <span className="font-bold text-green-600">{s.sales}</span>
                        </div>
                        <div className="flex justify-between bg-white p-2 rounded">
                          <span className="text-sm text-gray-600">Close Rate</span>
                          <span className="font-bold text-purple-600">{cr}%</span>
                        </div>
                      </div>
                    </button>
                  );
                })}
              </div>
            </div>

            {/* Activity Feed */}
            <div className="bg-white rounded-lg p-4 md:p-6">
              <h2 className="text-xl md:text-2xl font-bold mb-4">üî• Live Activity Feed</h2>
              <div className="space-y-2 max-h-80 overflow-y-auto">
                {activity.length === 0
                  ? <p className="text-center text-gray-400 py-8">No activity yet ‚Äî start logging!</p>
                  : activity.map(act => (
                    <div key={act.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                      <div className="text-2xl">{act.action==='call'?'üìû':act.action==='quote'?'üìã':'üí∞'}</div>
                      <div>
                        <p className="font-semibold text-sm">{act.agent} {act.action==='call'?'made':act.action==='quote'?'sent':'closed'} {act.details}</p>
                        <p className="text-xs text-gray-400">{new Date(act.timestamp).toLocaleString()}</p>
                      </div>
                    </div>
                  ))
                }
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
